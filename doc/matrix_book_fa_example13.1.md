---
title: "مثال ۱۳-۱: ماتریس افکنش در حداقل مربعات معمولی (اضافه‌کردن شرح در نمودار)"
author: "رامین مجاب"
output: md_document
---
##  مثال ۱۳-۱: ماتریس افکنش در حداقل مربعات معمولی (اضافه‌کردن شرح در نمودار)
<p style='font-size: 0.8em;'><b>نویسنده:</b> <span>رامین مجاب</span></p>

**(صفحهٔ ۳۴۷ کتاب)**

در [مثال ۱۱-۳](matrix_book_fa_example11.3)، در بحث تحلیل مؤلفهٔ اصلی، در یک نمودار در صفحهٔ مختصات نشان دادیم که این تحلیل چگونه جهتی را می‌یابد که «تفسیری از خطا» حداقل یا «تفسیری از پراکندگی» حداکثر است. در این مثال، توضیح می‌دهیم که چگونه تفسیر خطا و پراکندگی، در مسئلهٔ حداقل مربعات معمولی متفاوت است. در ابتدا، کدی مشابه با آنچه پیش‌تر داشتیم اجرا می‌کنیم:

``` r
> set.seed(123)
> X <- matrix(rnorm(30), ncol = 2)
> X <- X %*% matrix(c(1, 1, 0, 1), ncol = 2)
> pca <- prcomp(X)
```
همچنین در کد زیر،  افکنش تخمین‌زنندهٔ حداقل مربعات معمولی را محاسبه می‌کنیم:

``` r
> X1 <- X[, 1, drop = FALSE]
> X2 <- X[, 2, drop = FALSE]
> P <- X1 %*% solve(t(X1) %*% X1) %*% t(X1)
> ols_proj <- P %*% X2
```
برای آنکه نتیجه به بردار تبدیل نشود، 	از عبارت `drop=FALSE`   استفاده کرده‌ایم. در ادامه، نتایج را رسم می‌کنیم:

``` r
> plot(X, xlab = "X1", ylab = "X2", asp = 1)
> lines(c(0, pca$rotation[1, 1]) * 10,
+   c(0, pca$rotation[2, 1]) * 10,
+   col = "red"
+ )
> lines(c(0, -pca$rotation[1, 1]) * 10,
+   c(0, -pca$rotation[2, 1]) * 10,
+   col = "red"
+ )
> obs <- 3
> pca_proj <- X %*% pca$rotation[, 1]
> lines(
+   rbind(X[obs, ], c(
+     pca_proj[obs] * pca$rotation[1, 1],
+     pca_proj[obs] * pca$rotation[2, 1]
+   )),
+   col = "black", lty = 3
+ )
> lines(X1, ols_proj, col = "green", lwd = 2)
> lines(c(X1[obs], X1[obs]), c(X2[obs], ols_proj[obs]),
+   col = "blue", lty = 4
+ )
```

<img src="/rstatistics63/assets/images/matrix_book_fa/fig_ols_pca-1.svg" style="display: block; margin: auto;" />

با بیشتر دستورات کد موردنظر آشنا هستید. با توجه به اینکه خطوط مختلفی در این نمودار ترسیم شده است، عملاً نیاز است که اطلاعات را در نمودار شرح دهیم. تابع `legend()` این مهم را انجام می‌دهد. این بخش از کد به‌صورت زیر است:

``` r
> legend("topleft",
+   legend = c(
+     "PCA Direction", "OLS Line",
+     "OLS Error", "PCA Error"
+   ),
+   col = c("red", "green", "blue", "black"),
+   lty = c(1, 1, 3, 4), lwd = c(1, 2, 1, 1),
+   ncol = 2, cex = 0.7
+ )
```

```
# Error in (function (s, units = "user", cex = NULL, font = NULL, vfont = NULL, : plot.new has not been called yet
```

 اولین نکته آن است که جای مناسبی برای شرح بیابیم. در اینجا، از عبارت `"topleft"` استفاده کرده‌ایم؛ هرچند می‌توانیم یک نقطه در محور مختصات نیز تعیین کنیم و از گزینه‌های نسبتاً زیادی که وجود دارد، مکان را دقیق‌تر کنیم. این ممکن است نیازمند چندین‌بار اجرای کد باشد. 

آنچه در شرح نمودار در **R** قرار می‌گیرد، خودکار نیست، بلکه یک چهارچوب کاملاً منعطف برای طراحی آن وجود دارد، به‌طوری‌که اگر یک خط در نمودار با ویژگی‌های مشخص (نظیر رنگ، پهنا، نوع خط، و غیره) ترسیم شده است، همین خط با همین ویژگی‌ها قابل‌انتقال به شرح است. به‌عنوان تمرین، مشاهداتی که به‌صورت دایره در نمودار رسم شده است، به شرح وارد کنید. 

در نهایت، به مفهوم متفاوت خطا در دو نوع تحلیل توجه کنید. در تحلیل مؤلفهٔ اصلی، متعامدبودن افکنش یک ویژگی مهم است، اما این موضوع در افکنش حداقل مربعات معمولی موضوعیت ندارد و خطا با فاصله‌ای که هم‌راستا با محور مختصات عمودی است، اندازه‌گیری می‌شود. به‌عبارت دیگر در اینجا، خطا تفاوت مقدار متغیر وابسته و مقدار افکنش به‌ازای هر ارزشی برای متغیر توضیحی است. فارغ از این نکته، به یاد  داشته باشید که تحلیل مؤلفهٔ اصلی مربوط به جهت است و اگر در این نمودار خط رگرسیون نزدیک به آن است، به‌دلیل حذف عرض‌ازمبدأ از تحلیل است.
  	  


<p style='margin-bottom:3cm;'></p><hr/>

- [مثال ۱۲-۳: تخمین حداکثر درست‌نمایی (یک مثال کابردی برای بهینه‌یابی)](matrix_book_fa_example12.3.html)
- [مثال ۱۳-۲: مدل رگرسیون خطی چندگانه (معرفی تابع عمومی `summary()`)](matrix_book_fa_example13.2.html)
- [<b>لیست مثال‌ها</b>](matrix_book_fa.html)
