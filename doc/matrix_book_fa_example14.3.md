---
title: "مثال ۱۴-۳: تبدیل z و نمودارهای بزرگی و فاز (تمرین برنامه‌نویسی)"
author: "رامین مجاب"
output: md_document
---
##  مثال ۱۴-۳: تبدیل z و نمودارهای بزرگی و فاز (تمرین برنامه‌نویسی)
<p style='font-size: 0.8em;'><b>نویسنده:</b> <span>رامین مجاب</span></p>

**(صفحهٔ ۳۸۹ کتاب)**

مزیت بسیار مهم در استفاده از تبدیل `z` یک معادلهٔ تفاضلی از آنجاست که $z$ یک عدد مختلط است و می‌توان آن را در فرم قطبی نمایش داد. اگر $z=a+bi$ فرم دکارتی عدد مختلط باشد، آنگاه $z=r(\cos\phi+i \sin\phi)$ فرم قطبی آن است (واحد $\phi$  رادیان است).  در این حالت، $r=\sqrt{a^2+b^2}$ (یعنی اندازهٔ عدد مختلط) و $\phi=\arctan b/a$ است. در **R**، این ارزش‌ها را به‌ترتیب با توابع `Mod()`  و `Arg()` محاسبه می‌کنیم. همچنین با توجه به فرمول اویلر، تساوی $z=\exp(i\phi)$ نیز وجود دارد. کد زیر را ملاحظه کنید:

``` r
> transfer.fun <- function(d = 0.5) {
+   freq <- seq(-pi, pi, length.out = 1000)
+   H <- 1 / (1 - d * exp(-1i * freq))
+   list(freq = freq, r = Mod(H), phi = Arg(H))
+ }
```
این تابع برای یک معادلهٔ تفاضلی خطی مرتبهٔ اول، همانند آنچه در متن بحث شده است، ارزش‌های بزرگی و فاز تابع انتقال را محاسبه می‌کند و بازمی‌گرداند. در ادامه، از این ارزش‌ها برای رسم نمودار بزرگی و فاز استفاده خواهیم کرد. توجه کنید که در خط اول، فرکانس‌های $-\pi$ تا $\pi$ را انتخاب کرده‌ایم که یک انتخاب معمول است. نکتهٔ دیگری که باید توجه کرد، علامت منفی در  `-1i * freq` است. این به‌دلیل وجود $z^{-1}$ در کد است. در ادامه، بزرگی تابع انتقال را به‌ازای دو پارامتر رسم می‌کنیم:


``` r
> par <- par(mar = c(4, 4, 2, 2) + 0.1)
> 
> h1 <- transfer.fun(0.8)
> plot(h1$freq, h1$r,
+   type = "l", xlab = "فرکانس", ylab = "بزرگی",
+   lwd = 2, col = "black"
+ )
> 
> h2 <- transfer.fun(0.4)
> lines(h2$freq, h2$r, type = "l", lwd = 2, col = "red", lty = 2)
> 
> legend("topleft",
+   legend = c("d=0.8", "d=0.4"), col = c("black", "red"),
+   lwd = 2, lty = c(1, 2)
+ )
```

<img src="/rstatistics63/assets/images/matrix_book_fa/fig_z_magnitude-1.svg" style="display: block; margin: auto;" />

نمودار فوق نشان می‌دهد که تابع انتقال اصطلاحاً یک فیلتر پایین‌گذر (<span dir="ltr">low-pass filter</span>) است، زیرا وزن بیشتری به فرکانس‌های پایین‌تر می‌دهد. هرچه پارامتر $c$ افزایش می‌یابد و به‌سمت 1 نزدیک‌تر می‌شود، وزن فرکانس‌های کوچک‌تر در خروجی بیشتر می‌شود. به بیان دیگر، با افزایش پارامتر $c$، پهنای باند (bandwidth) کاهش می‌یابد. به‌طور شهودی، فرکانس‌های پایین‌تر  به ترکیبات بلندمدت‌تر مربوط‌اند و  افزایش $c$  باعث افزایش وزن این ترکیبات در خروجی می‌شود. به بیان دیگر، خروجی‌ها حافظهٔ بلندمدت‌تری دارند و   گذشتهٔ خود را برای مدت‌زمان طولانی‌تری به یاد  می‌آورند. این موضوع را می‌توانید با جای‌گذاری پیاپی  در معادلهٔ $y_{t+1}=cy_{t}$ و مثلاً محاسبه مشتق‌های جزئی بررسی کنید. اکنون، به رسم نمودار فاز می‌پردازیم.



``` r
> par <- par(mar = c(4, 4, 2, 2) + 0.1)
> 
> plot(h1$freq, h1$phi,
+   type = "l", xlab = "Frequency", ylab = "Phase",
+   lwd = 2, col = "black"
+ )
> 
> lines(h2$freq, h2$phi, type = "l", lwd = 2, col = "red", lty = 2)
> 
> legend("topright",
+   legend = c("d=0.8", "d=0.4"), col = c("black", "red"),
+   lwd = 2, lty = c(1, 2)
+ )
```

<img src="/rstatistics63/assets/images/matrix_book_fa/fig_z_phase-1.svg" style="display: block; margin: auto;" />

دو مشاهده در نتایج این نمودار مهم است: اولاً، در فرکانس‌های منفی، فاز مثبت و در فرکانس‌های مثبت، فاز منفی است. این ویژگی مدل‌های علّی (<span dir="ltr">causal system</span>) است. در چنین مدل‌هایی، خروجی به آینده بستگی ندارد و تنها تحت‌تأثیر ورودی‌های حال و گذشته است.  در معادلهٔ تفاضلی مرتبهٔ اول این مثال، این ویژگی مشهود است. چنین شرایطی  ممکن است با نام تأخیر فاز (<span dir="ltr">phase lag</span>) نیز معرفی شود. نکتهٔ دوم آن است که با افزایش پارامتر $d$، شیب نمودار به‌طور مطلق افزایش می‌یابد. توضیح این مشاهده، مانند آن‌چیزی است که دربارهٔ بزرگی بیان شد. وقتی $d$ کوچک است، مدل سریعاً گذشته را فراموش می‌کند و بنابراین تأخیر فاز کمتری نیز وجود خواهد داشت.



<p style='margin-bottom:3cm;'></p><hr/>

- [مثال ۱۴-۲: تعادل در مدل تارعنکبوتی (تمرین برنامه‌نویسی)](matrix_book_fa_example14.2.html)
- [مثال ۱۴-۴: شبیه‌سازی با مدل تصحیح خطای برداری (تمرین برنامه‌نویسی و رسم نمودار)](matrix_book_fa_example14.4.html)
- [<b>لیست مثال‌ها</b>](matrix_book_fa.html)
