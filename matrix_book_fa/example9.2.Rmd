---
title: "مثال ۹-۲: حل دستگاه معادلات با استفاده از تجزیه‌های مختلف ماتریس (اهمیت پایداری عددی الگوریتم‌ها)"
author: "رامین مجاب"
output: md_document
---

**(صفحهٔ ۲۸۹ کتاب)**

در این مثال، بحث پایداری عددی الگوریتم‌های مختلف در حل دستگاه معادلات مطرح می‌شود. در ابتدا، توابع زیر را برای حل یک دستگاه خطی، با استفاده از نتایج تجزیه‌های مختلف، تعریف می‌کنیم:
```{r}
lu.solve <- function(A, b) {
  lu <- Matrix::lu(A)
  x <- Matrix::solve(lu, b)
  return(x)
}
 
cholesky.solve <- function(A, b) {
  R <- chol(A)
  y <- forwardsolve(t(R), b)
  x <- backsolve(R, y)
}
 
qr.solve <- function(A, b) {
  qr <- qr(A)
  solve(qr, b)
}
 
svd.solve <- function(A, b) {
  svd <- svd(A)
  svd$v %*% (t(svd$u) %*% b / svd$d)
}
 
eigen.solve <- function(A, b) {
  eigen <- eigen(A)
  eigen$vectors %*% (t(eigen$vectors) %*% b / eigen$values)
}
```
به‌دلیل اینکه نام‌گذاری و منطق هر تابع واضح است، توضیحات اضافی ارائه نمی‌شود. البته، این نکته را لحاظ کنید که تمام این توابع را نمی‌توان با هر نوع ماتریسی استفاده کرد. بااین‌حال، تمام این توابع یک ماتریس مثبت معین را می‌پذیرند. در کد زیر، چنین ماتریسی را به‌صورت تصادفی ایجاد می‌کنیم:
```{r}
set.seed(123)
m <- 1000
A <- matrix(rnorm(m * m), nrow = m)
A <- (A + t(A)) / 2
A <- tcrossprod(A)
b <- rnorm(m)
```
خط سوم، ماتریس تصادفی را متقارن و خط چهارم، آن را به یک ماتریس مثبت معین تبدیل می‌کند. خط آخر نیز بردار ثابت‌ها را به‌صورت تصادفی ایجاد می‌کند. اکنون دستگاه خطی را که با این ماتریس تعریف می‌شود، با روش‌های مختلف حل می‌کنیم:
```{r}
solutions <- list(
  lu = lu.solve(A, b),
  chol = cholesky.solve(A, b),
  qr = qr.solve(A, b),
  svd = svd.solve(A, b),
  eigen = eigen.solve(A, b)
)
```

برای گزارش پایداری عددی، می‌توان نُرم خطاها را به‌صورت زیر گزارش کرد:
```{r} 
sapply(solutions, function(x) norm(A %*% x - b))
```
کدهای فوق برای رسیدن به یک مقایسهٔ عادلانه فاصلهٔ زیادی دارد. [مثال ۳-۴](matrix_book_fa_example3.4) را به یاد  بیاورید و آنکه نیاز به متوسط‌گیری بر ماتریس‌های تصادفی وجود دارد؛ هرچند مسئلهٔ مهم‌تر به فرض اولیه بازمی‌گردد؛ اینکه ماتریس را مثبت معین لحاظ کردیم و الگوریتمی نظیر تجزیهٔ چولسکی، عملاً از حجم اطلاعات بیشتری استفاده می‌کند، یا الگوریتم تجزیهٔ ویژه از ویژگی متقارن‌بودن این ماتریس استفاده می‌کند.

به‌عنوان تمرین، برای توابعی که امکان‌پذیر است، بحث فوق را برای یک ماتریس نامتقارن تکرار کنید.



