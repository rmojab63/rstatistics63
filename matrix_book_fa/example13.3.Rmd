---
title: "مثال ۱۳-۳: تخمین مدل معادلات هم‌زمان (مفهوم صادرشدن اشیاء از یک بستهٔ نرم‌افزاری)"
author: "رامین مجاب"
output: md_document
---

 **(صفحهٔ ۳۷۰ کتاب)**

در این مثال، سیستم معادلات هم‌زمان مدل اول کلین (`Klein`)  را تخمین می‌زنیم و سپس تغییر مسیر حرکت تولید را در یک سناریوی سیاستی بررسی می‌کنیم. این مدل در <span dir="ltr">@greene2020econometric</span> ص. ۴۰۴  گزارش شده است و شامل سه معادله برای مصرف، سرمایه‌گذاری، و دستمزد خصوصی است. داده‌های موردنیاز را توسط کد زیر از بستهٔ نرم‌افزاری `systemfit` استخراج می‌کنیم (این بسته لازم است نصب شود):
```{r}
data("KleinI", package = "systemfit")
```
موضوعی که  به توجه نیاز دارد آن است که شما نمی‌توانید به شیء `KleinI` از طریق علامت `::` دسترسی پیدا کنید؛ یعنی، حاصل عبارت `systemfit::KleinI` یک خطاست که توضیح می‌دهد  چنین چیزی در فضای‌نام (`namespace`) موردنظر وجود ندارد. درواقع در یک بستهٔ نرم‌افزاری،  تنها به شیء‌هایی دسترسی دارید که صادر (یا `export`) شده باشند. اینکه کدام شیء (مثلاً تابع، داده، یا ثابت) از یک بسته صادر شود، به انتخاب توسعه‌دهنده است. البته، می‌توانید به شیءهایی که صادر نمی‌شوند، با نوشتن نام  بسته و سپس علامت `:::` (سه تا دو نقطه) دسترسی پیدا کنید؛ اما به یاد بسپارید که اگر  تابعی یا شیء دیگری توسط توسعه‌دهنده صادر نشده است، احتمالاً دلیل خوبی داشته است و استفادهٔ مستقیم از آن، باید با احتیاط صورت گیرد. 

درهرحال، کد فوق یک `data.frame` با نام `KleinI` در محیط فعلی بارگذاری می‌کند. این روش دیگری برای ارائهٔ یک بسته، همراه با برخی مجموعه داده است (در مقایسه با صادرکردن مستقیم مجموعه داده و استفاده از فرایندی با نام `lazy data loading`). اگر دستور `data(package="systemfit")` را  اجرا کنید، لیستی از همهٔ داده‌هایی که در بستهٔ موردنظر وجود دارد، نمایش داده می‌شود. 

اکنون با استفاده از مدل نظری <span dir="ltr">@greene2020econometric</span> ص. ۴۰۴ و در کد زیر، مدل موردنظر را تخمین می‌زنیم:

```{r}
system <- list(
  C = consump ~ corpProf + corpProfLag + I(privWage + govWage),
  I = invest ~ corpProf + corpProfLag + capitalLag,
  W = privWage ~ gnp + gnpLag + trend
)

inst <- ~ govExp + taxes + govWage + trend + capitalLag +
  corpProfLag + gnpLag

model <- systemfit::systemfit(system, "3SLS",
  inst = inst,
  data = KleinI
)

```

در کد فوق، برخلاف آنچه در متن بحث شد، از تخمین‌زنندهٔ حداکثر درست‌نمایی  استفاده نکرده‌ایم (به‌دلیل نبود این گزینه در تابع `systemfit`). مدل با روش `3SLS` تخمین زده شده است. این روش نیازمند یک مجموعه از متغیرهای ابزاری است که در عبارت `inst` تعریف شده‌اند. همچنین، به کاربرد کد `I()` در نوشتن  _عبارت_ آن توجه کنید. با این دستور، تنها یک ضریب برای جمع دستمزد خصوصی و دولتی تعریف می‌شود. 

می‌توانید با استفاده از تابع `summary()` و غیره، به تحلیل نتایج به‌دست‌آمده از تخمین بپردازید. در ادامه، هدف دیگری را دنبال می‌کنیم و سعی می‌کنیم اثر یک سناریوی سیاستی را بر مسیر حرکت متغیر `gnp` بررسی کنیم. در این حالت، مخارج دولتی را ۱۰ درصد در همهٔ دوره‌ها افزایش می‌دهیم و با استفاده از مدل، تولید، سرمایه‌گذاری، و مصرف خصوصی را با توجه به داده‌های جدید پیش‌بینی می‌کنیم. کد زیر را ببینید:

```{r}
KleinI_p <- KleinI
KleinI_p$govExp <- KleinI_p$govExp * 1.10
pred_p <- predict(model, newdata = KleinI_p)
KleinI_p$gnp <- c(NA, pred_p$C.pred) + c(NA, pred_p$I.pred) +
  KleinI_p$govExp
```

خط اول یک `data.frame` برای ذخیرهٔ تغییرات سناریوی سیاست‌گذاری ایجاد می‌کند. خط آخر مقدار `gnp` تحت سناریوی جدید را محاسبه می‌کند. اگر مدل `Klein` را ببینید، متوجه می‌شوید که سه اتحاد نیز وجود دارد. یکی از این اتحادها مربوط به تعادل است که می‌گوید: مجموع مصرف، سرمایه‌گذاری، و مخارج دولتی برابر با تولید است. در اینجا، از این اتحاد استفاده شده است. در ادامه، دو مسیر `gnp` با یکدیگر مقایسه می‌شود.

```{r fig_Klein, fig.align='center', fig.cap="", fig.width=5, fig.height=3}
par <- par(mar = c(2, 2, 2, 2) + 0.1)
plot(KleinI$year, KleinI$gnp, type = "l", col = c("black", "red"), xlab = "Time", ylab = "GNP")
lines(KleinI$year, KleinI_p$gnp, col = "red", lty = 2)
legend("topleft", legend = c("Old GNP", "New GNP"), col = c("black", "red"), lty = c(1, 2), cex = 0.8)
```




