---
title: "مثال ۱۴-۲: تعادل در مدل تارعنکبوتی (تمرین برنامه‌نویسی)"
author: "رامین مجاب"
output: md_document
---

**(صفحهٔ ۳۷۸ کتاب)**
 
احتمالاً با پدیدهٔ تارعنکبوتی (cobweb) در اقتصاد  آشنا باشید. در یک مدل عرضه و تقاضای پویا، که در آن کشاورزان باید در دورهٔ جاری  برای میزان سطح کاشت محصولات در دورهٔ بعد تصمیم‌گیری کنند، این پدیده رخ می‌دهد. آن‌ها بر اساس قیمت‌های دورهٔ فعلی تصمیم می‌گیرند و تقاضا در دورهٔ بعد، با توجه به قیمت‌های همان دوره شکل می‌گیرد.  بسته به اندازهٔ نسبی شیب توابع عرضه و تقاضا، ارزش تقاضا، عرضه، و قیمت نوسان خواهد داشت. قیمت و مقدار ممکن است به نقطهٔ تعادل نزدیک شود یا از آن فاصله بگیرد. اگر توابع عرضه و تقاضا را به‌ترتیب به‌صورت $D_t=-aP_t+b$ و $S_t=cP_{t-1}+d$ نمایش دهیم (همهٔ پارامترها مثبت‌اند)، در این‌صورت در تعادل (یعنی $D=S$) تساوی زیر حاکم است:

$$P_t = -\frac{c}{a}P_{t-1} + \frac{b-d}{a}$$

 این یک معادلهٔ تفاضلی خطی مرتبهٔ اول است. در ادامه، می‌خواهیم پویایی‌های این مدل در رسیدن به تعادل را بررسی کنیم. در کد زیر، توابع تقاضا و عرضه و معکوس آن‌ها را تعریف می‌کنیم:

```{r}
a <- 2
b <- 10
c <- 1
d <- 2

qD <- function(p) {
  -a * p + b
}
qS <- function(p) {
  c * p + d
}
pD <- function(q) {
  (b - q) / a
}
pS <- function(q) {
  (q - d) / c
}

```
اگر به معادلهٔ تفاضلی دقت کنید، با توجه به رابطهٔ ۱۴-۳ (صفحهٔ ۳۷۴ در کتاب)، نسبت شیب تابع عرضه به شیب تابع تقاضا  رفتار تعادلی قیمت را تعیین می‌کند. پارامترهای کد فوق، حالتی را نشان می‌دهند که تعادل برقرار می‌شود. اکنون، پویایی‌های مدل را در فضای مقدار-قیمت رسم می‌کنیم:

```{r fig_cobweb, fig.align='center', fig.cap="", fig.width=3.5, fig.height=3.5}
par <- par(mar = c(4,4,2,2) + 0.1)
max_x <- 10
max_y <- 8
p_s <- 6
q_s <- qS(p_s)

plot(q_s, p_s,
  type = "n", ylim = c(0, max_y), xlim = c(0, max_x),
  asp = 1, xlab = "Q", ylab = "P"
) 
curve(pD(x),
  from = 0, to = max_x,
  add = TRUE, col = "gray", lty = 2
)
curve(pS(x),
  from = 0, to = max_x,
  add = TRUE, col = "black", lty = 2
) 
for (i in 1:100) {
  p_d <- pD(q_s)
  p_s <- pS(q_s)
  arrows(
    x0 = q_s, y0 = p_s, x1 = q_s + 0.01, y1 = p_d,
    length = 0.05, col = "red"
  ) 
  q_d <- qD(p_d)
  q_s <- qS(p_d)
  arrows(
    x0 = q_d, y0 = p_d, x1 = q_s + 0.01, y1 = p_d,
    length = 0.05, col = "blue", lty = 2
  )
}
```
برخی توابع در کد مربوطه جدیدند و مطالعهٔ توضیحات آن‌ها به خواننده واگذار می‌شود. به‌عنوان تمرین، پارامترها را به‌گونه‌ای تغییر دهید که قیمت واگرا باشد. در این حالت که مدل واگراست، آیا عرضه‌کنندگان به قیمت‌ها حساس‌ترند یا تقاضاکنندگان؟ این نمودار بدون شرح است. نمودارها باید در نگاه اول (و بدون خواندن متن) نیز  یک درک اولیه ایجاد کنند. این نمودار این‌گونه نیست. به‌عنوان تمرین، با تابع `legend()`، یک شرح برای آن بنویسید.

